name: ClaudeChain Statistics

# This is an example workflow showing how to use ClaudeChain Statistics with Slack
# It demonstrates:
# 1. Generating statistics using the statistics-action
# 2. Automatic Slack notifications via action input
# 3. Scheduling for daily reports

on:
  # schedule:
  #   - cron: '0 9 * * *'  # Daily at 9 AM UTC
  workflow_dispatch:  # Allow manual trigger for testing
    inputs:
      base_branch:
        description: 'Base branch where spec files are located'
        required: false

env:
  DEFAULT_BASE_BRANCH: 'main'

permissions:
  contents: read
  actions: read

jobs:
  statistics:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Generate ClaudeChain Statistics
        id: stats
        uses: ./statistics  # Use local action (for this repo)
        # For external repos, use: gestrich/claude-chain/statistics@v1
        with:
          workflow_name: 'ClaudeChain'  # Must match the name: property in claude-chain.yml
          github_token: ${{ secrets.GITHUB_TOKEN }}
          # config_path: refactor/my-project/configuration.json # Use for per-project statitics
          base_branch: ${{ github.event.inputs.base_branch || env.DEFAULT_BASE_BRANCH }}
          days_back: 30
          slack_webhook_url: ${{ secrets.CLAUDE_CHAIN_SLACK_WEBHOOK_URL }}
          show_assignee_stats: 'true'